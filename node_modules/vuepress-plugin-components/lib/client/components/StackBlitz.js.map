{"version":3,"file":"StackBlitz.js","sources":["../../../src/client/composables/size.ts","../../../src/client/components/StackBlitz.ts"],"sourcesContent":["import { useEventListener } from \"@vueuse/core\";\nimport { computed, onMounted, isRef, ref, unref, watch } from \"vue\";\nimport type { MaybeRef } from \"@vueuse/core\";\nimport type { Ref } from \"vue\";\n\nconst getValue = (value: string | number): string =>\n  typeof value === \"string\" ? value : `${value}px`;\n\nexport interface SizeOptions {\n  width: string | number | undefined;\n  height: string | number | undefined;\n  ratio: string | number | undefined;\n}\n\nexport interface SizeInfo<E extends HTMLElement> {\n  el: Ref<E | undefined>;\n  width: Ref<string>;\n  height: Ref<string>;\n}\n\nexport const useSize = <E extends HTMLElement>(\n  options: SizeOptions,\n  extraHeight: MaybeRef<number> = 0\n): SizeInfo<E> => {\n  const el = ref<E>();\n  const width = computed(() => getValue(unref(options.width) || \"100%\"));\n  const height = ref(\"auto\");\n\n  const getRadio = (radio: number | string | undefined): number => {\n    if (typeof radio === \"string\") {\n      const [width, height] = radio.split(\":\");\n      const parsedRadio = Number(width) / Number(height);\n\n      if (!Number.isNaN(parsedRadio)) return parsedRadio;\n    }\n\n    return typeof radio === \"number\" ? radio : 16 / 9;\n  };\n\n  const getHeight = (width: number): string => {\n    const height = unref(options.height);\n    const ratio = getRadio(unref(options.ratio));\n\n    return height\n      ? getValue(height)\n      : `${Number(width) / ratio + unref(extraHeight)}px`;\n  };\n\n  const updateHeight = (): void => {\n    if (el.value) height.value = getHeight(el.value.clientWidth);\n  };\n\n  onMounted(() => {\n    updateHeight();\n    if (isRef(extraHeight)) watch(extraHeight, () => updateHeight());\n    useEventListener(\"orientationchange\", () => updateHeight());\n    useEventListener(\"resize\", () => updateHeight());\n  });\n\n  return {\n    el,\n    width,\n    height,\n  };\n};\n","/* eslint-disable vue/no-unused-properties */\nimport { defineComponent, h } from \"vue\";\nimport { useSize } from \"../composables/index.js\";\n\nimport type { VNode, PropType } from \"vue\";\n\nimport \"../styles/stack-blitz.scss\";\nexport default defineComponent({\n  name: \"StackBlitz\",\n\n  props: {\n    /**\n     * StackBlitz id\n     *\n     * @description Full StackBlitz url is also supported\n     *\n     * StackBlitz ID\n     *\n     * @description 也支持完整的 StackBlitz 链接\n     */\n    id: {\n      type: String,\n      required: true,\n    },\n\n    /**\n     * Component width\n     *\n     * 组件宽度\n     */\n    width: {\n      type: [String, Number],\n      default: \"100%\",\n    },\n\n    /**\n     * Component height\n     *\n     * 组件高度\n     */\n    height: {\n      type: [String, Number],\n      default: undefined,\n    },\n\n    /**\n     * Component width / height ratio\n     *\n     * 组件长宽比\n     */\n    ratio: {\n      type: [String, Number],\n      default: 16 / 9,\n    },\n\n    /**\n     * The default file to open in the editor\n     *\n     * 默认打开的文件\n     */\n    file: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * The initial URL path the preview should open\n     *\n     * 预览的初始 URL 路径\n     */\n    initialPath: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * Force embed view regardless of screen size\n     *\n     * 强制嵌入视图，无论屏幕尺寸如何\n     */\n    embed: Boolean,\n\n    /**\n     * Whether load embed demo directly\n     *\n     * 是否直接加载嵌入演示\n     */\n    load: Boolean,\n\n    /**\n     * Which view to open by default\n     *\n     * 默认打开的视图\n     */\n    view: {\n      type: String as PropType<\"editor\" | \"preview\">,\n      default: \"preview\",\n    },\n\n    /**\n     * Hide file explorer panel in embed view\n     *\n     * 在嵌入视图中隐藏文件资源管理器面板\n     */\n    hideExplorer: Boolean,\n\n    /**\n     * Hide file explorer panel in embed view\n     *\n     * 在嵌入视图中隐藏文件资源管理器面板\n     */\n    hideNavigation: Boolean,\n\n    /**\n     * Hide the debugging console in the editor preview\n     *\n     * 隐藏编辑器预览中的调试控制台\n     */\n    hideDevtools: Boolean,\n  },\n\n  setup(props) {\n    const { el, width, height } = useSize<HTMLIFrameElement>(props);\n\n    return (): VNode =>\n      h(\"iframe\", {\n        ref: el,\n        class: \"stack-blitz-iframe\",\n        src: `https://stackblitz.com/edit/${props.id}?embed=${\n          props.embed ? 1 : 0\n        }${props.file ? `&file=${props.file}` : \"\"}${\n          props.initialPath\n            ? `&initialpath=${encodeURI(props.initialPath)}`\n            : \"\"\n        }&ctl=${props.load ? 0 : 1}&view=${props.view}${\n          props.hideExplorer ? \"&hideExplorer=1\" : \"\"\n        }${props.hideNavigation ? \"&hideNavigation=1\" : \"\"}${\n          props.hideDevtools ? \"&hidedevtools=1\" : \"\"\n        }`,\n        allow: \"clipboard-write\",\n        style: {\n          width: width.value,\n          height: height.value,\n        },\n      });\n  },\n});\n"],"names":["getValue","value","useSize","options","extraHeight","el","ref","width","computed","unref","height","getRadio","radio","parsedRadio","getHeight","ratio","updateHeight","onMounted","isRef","watch","useEventListener","StackBlitz","defineComponent","props","h"],"mappings":"uMAKA,MAAMA,EAAYC,GAChB,OAAOA,GAAU,SAAWA,EAAQ,GAAGA,MAc5BC,EAAU,CACrBC,EACAC,EAAgC,IAChB,CAChB,MAAMC,EAAKC,EAAAA,EACLC,EAAQC,EAAS,IAAMR,EAASS,EAAMN,EAAQ,KAAK,GAAK,MAAM,CAAC,EAC/DO,EAASJ,EAAI,MAAM,EAEnBK,EAAYC,GAA+C,CAC/D,GAAI,OAAOA,GAAU,SAAU,CAC7B,KAAM,CAACL,EAAOG,CAAM,EAAIE,EAAM,MAAM,GAAG,EACjCC,EAAc,OAAON,CAAK,EAAI,OAAOG,CAAM,EAEjD,GAAI,CAAC,OAAO,MAAMG,CAAW,EAAG,OAAOA,CACzC,CAEA,OAAO,OAAOD,GAAU,SAAWA,EAAQ,GAAK,CAClD,EAEME,EAAaP,GAA0B,CAC3C,MAAMG,EAASD,EAAMN,EAAQ,MAAM,EAC7BY,EAAQJ,EAASF,EAAMN,EAAQ,KAAK,CAAC,EAE3C,OAAOO,EACHV,EAASU,CAAM,EACf,GAAG,OAAOH,CAAK,EAAIQ,EAAQN,EAAML,CAAW,KAClD,EAEMY,EAAe,IAAY,CAC3BX,EAAG,QAAOK,EAAO,MAAQI,EAAUT,EAAG,MAAM,WAAW,EAC7D,EAEA,OAAAY,EAAU,IAAM,CACdD,EACIE,EAAAA,EAAMd,CAAW,GAAGe,EAAMf,EAAa,IAAMY,EAAAA,CAAc,EAC/DI,EAAiB,oBAAqB,IAAMJ,EAAc,CAAA,EAC1DI,EAAiB,SAAU,IAAMJ,GAAc,CACjD,CAAC,EAEM,CACL,GAAAX,EACA,MAAAE,EACA,OAAAG,CACF,CACF,ECzDA,IAAAW,EAAeC,EAAgB,CAC7B,KAAM,aAEN,MAAO,CAUL,GAAI,CACF,KAAM,OACN,SAAU,EACZ,EAOA,MAAO,CACL,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,MACX,EAOA,OAAQ,CACN,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,MACX,EAOA,MAAO,CACL,KAAM,CAAC,OAAQ,MAAM,EACrB,QAAS,GAAK,CAChB,EAOA,KAAM,CACJ,KAAM,OACN,QAAS,EACX,EAOA,YAAa,CACX,KAAM,OACN,QAAS,EACX,EAOA,MAAO,QAOP,KAAM,QAON,KAAM,CACJ,KAAM,OACN,QAAS,SACX,EAOA,aAAc,QAOd,eAAgB,QAOhB,aAAc,OAChB,EAEA,MAAMC,EAAO,CACX,KAAM,CAAE,GAAAlB,EAAI,MAAAE,EAAO,OAAAG,CAAO,EAAIR,EAA2BqB,CAAK,EAE9D,MAAO,IACLC,EAAE,SAAU,CACV,IAAKnB,EACL,MAAO,qBACP,IAAK,+BAA+BkB,EAAM,YACxCA,EAAM,MAAQ,EAAI,IACjBA,EAAM,KAAO,SAASA,EAAM,OAAS,KACtCA,EAAM,YACF,gBAAgB,UAAUA,EAAM,WAAW,IAC3C,UACEA,EAAM,KAAO,EAAI,UAAUA,EAAM,OACvCA,EAAM,aAAe,kBAAoB,KACxCA,EAAM,eAAiB,oBAAsB,KAC9CA,EAAM,aAAe,kBAAoB,KAE3C,MAAO,kBACP,MAAO,CACL,MAAOhB,EAAM,MACb,OAAQG,EAAO,KACjB,CACF,CAAC,CACL,CACF,CAAC"}