{"version":3,"file":"theme.js","sourceRoot":"","sources":["../../../src/node/compact/theme.ts"],"names":[],"mappings":"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","sourcesContent":["import { convertNavbarOptions } from \"./navbar.js\";\nimport { convertSidebarOptions } from \"./sidebar.js\";\nimport { droppedLogger, deprecatedLogger } from \"./utils.js\";\nimport { logger } from \"../utils.js\";\n\nimport type { ThemeOptions } from \"../../shared/index.js\";\n\nconst DEPRECATED_THEME_OPTIONS: [string, string][] = [\n  // v1\n  [\"darkLogo\", \"logoDark\"],\n  [\"navAutoHide\", \"navbarAutoHide\"],\n  [\"hideSiteTitleonMobile\", \"hideSiteNameOnMobile\"],\n  [\"sidebarDepth \", \"headerDepth\"],\n  [\"prevLinks\", \"prevLink\"],\n  [\"nextLinks\", \"nextLink\"],\n  [\"editLinks\", \"editLink\"],\n  [\"updateTime\", \"lastUpdated\"],\n  [\"anchorDisplay\", \"toc\"],\n  [\"nav\", \"navbar\"],\n  [\"activeHash\", \"plugins.activeHeaderLinks\"],\n  [\"comment\", \"plugins.comment\"],\n  [\"copyCode\", \"plugins.copyCode\"],\n  [\"copyright\", \"plugins.copyright\"],\n  [\"feed\", \"plugins.feed\"],\n  [\"git\", \"plugins.git\"],\n  [\"mdEnhance\", \"plugins.mdEnhance\"],\n  [\"readingTime\", \"plugins.readingTime\"],\n  [\"photoswipe\", \"plugins.photoswipe\"],\n  [\"pwa\", \"plugins.pwa\"],\n  [\"sitemap\", \"plugins.sitemap\"],\n  [\"seo\", \"plugins.seo\"],\n  [\"wordPerMinute\", \"plugins.readingTime.wordPerMinute\"],\n\n  // v2\n  [\"hideSiteNameonMobile\", \"hideSiteNameOnMobile\"],\n  [\"fullScreen\", \"fullscreen\"],\n  [\"headingDepth\", \"headerDepth\"],\n];\n\nconst DROPPED_THEME_OPTIONS: [string, string?, string?][] = [\n  // v1\n  [\n    \"algolia\",\n    'The theme no longer bundles docsearch package, you should install and use \"@vuepress/plugin-docsearch\".',\n  ],\n  [\n    \"algoliaType\",\n    'The theme no longer bundles docsearch package, you should install and use \"@vuepress/plugin-docsearch\".',\n  ],\n  [\n    \"custom\",\n    \"VuePress2 remove markdown slot support, you should extend theme layout to support similar feature.\",\n  ],\n  [\n    \"displayAllHeaders\",\n    \"Due to scalability consideration, V2 no longer supports this.\",\n  ],\n  [\n    \"chunkRename\",\n    \"Since it's hard to implement such feature on vite, we no longer support this plugin in V2.\",\n  ],\n  [\n    \"cleanUrl\",\n    \"Due to better seo consideration, we no longer support this plugin in V2.\",\n  ],\n  [\n    \"smoothScroll\",\n    \"We provides smooth scrolling via CSS in V2, so this plugin is no longer needed.\",\n  ],\n];\n\n/**\n * @deprecated You should use V2 standard options and avoid using it\n */\nconst handleBlogOptions = (blogOptions: Record<string, unknown>): void => {\n  if (\"links\" in blogOptions) {\n    logger.warn(\n      '\"blog.links\" options is deprecated, please use \"blog.medias\" instead'\n    );\n    blogOptions[\"medias\"] = blogOptions[\"links\"];\n    delete blogOptions[\"links\"];\n  }\n\n  if (\"perPage\" in blogOptions) {\n    logger.warn(\n      '\"blog.perPage\" options is deprecated, please use \"blog.articlePerPage\" instead'\n    );\n    blogOptions[\"articlePerPage\"] = blogOptions[\"perPage\"];\n    delete blogOptions[\"perPage\"];\n  }\n\n  if (\"autoExcerpt\" in blogOptions) {\n    logger.error(\n      '\"blog.autoExcerpt\" options is no longer supported, please use \"plugins.blog.excerptLength\" instead'\n    );\n    delete blogOptions[\"autoExcerpt\"];\n  }\n};\n\n/**\n * @deprecated You should use V2 standard options and avoid using it\n */\nconst handleFooterOptions = (options: Record<string, unknown>): void => {\n  if (typeof options[\"footer\"] === \"object\" && options[\"footer\"]) {\n    const footer = options[\"footer\"];\n\n    if (\"copyright\" in footer) {\n      logger.warn(\n        '\"footer.copyright\" options is deprecated, please use \"copyright\" instead'\n      );\n\n      // @ts-ignore\n      options[\"copyright\"] = footer[\"copyright\"];\n    }\n\n    if (\"display\" in footer) {\n      logger.warn(\n        '\"footer.display\" options is deprecated, please use \"displayFooter\" instead'\n      );\n\n      // @ts-ignore\n      options[\"displayFooter\"] = footer[\"display\"];\n    }\n\n    if (\"content\" in footer) {\n      logger.warn(\n        '\"footer.content\" options is deprecated, please use \"footer\" instead'\n      );\n\n      // @ts-ignore\n      options[\"footer\"] = footer[\"content\"];\n    } else delete options[\"footer\"];\n  }\n};\n\n/**\n * @deprecated You should use V2 standard options and avoid using it\n */\nexport const convertThemeOptions = (\n  themeOptions: Record<string, unknown>\n): ThemeOptions => {\n  // ensure plugins\n  const plugins = (themeOptions[\"plugins\"] =\n    (themeOptions[\"plugins\"] as Record<string, unknown>) || {});\n\n  DEPRECATED_THEME_OPTIONS.forEach(([deprecatedOption, newOption]) =>\n    deprecatedLogger({\n      options: themeOptions,\n      deprecatedOption,\n      newOption,\n      scope: \"themeConfig\",\n    })\n  );\n  DROPPED_THEME_OPTIONS.forEach((item) => droppedLogger(themeOptions, ...item));\n\n  // handle navbar\n  if (\"navbar\" in themeOptions)\n    themeOptions[\"navbar\"] = convertNavbarOptions(themeOptions[\"navbar\"]);\n\n  // handle sidebar\n  if (\"sidebar\" in themeOptions)\n    themeOptions[\"sidebar\"] = convertSidebarOptions(themeOptions[\"sidebar\"]);\n\n  // handle footer\n  handleFooterOptions(themeOptions);\n\n  // handle blog\n  if (typeof themeOptions[\"blog\"] === \"object\" && themeOptions[\"blog\"]) {\n    handleBlogOptions(themeOptions[\"blog\"] as Record<string, unknown>);\n    if (!plugins[\"blog\"]) plugins[\"blog\"] = true;\n  }\n\n  // handle component\n  if (Array.isArray(plugins[\"components\"])) {\n    logger.warn(\n      '\"plugins.components\" no longer accpets array, please set it to \"plugin.components.components\" instead.'\n    );\n\n    plugins[\"components\"] = {\n      components: plugins[\"components\"],\n    };\n  }\n\n  // handle addThis\n  if (themeOptions[\"addThis\"])\n    deprecatedLogger({\n      options: themeOptions,\n      deprecatedOption: \"addThis\",\n      newOption: \"plugins.components.rootComponents.addThis\",\n      scope: \"themeConfig\",\n    });\n\n  if (typeof themeOptions[\"encrypt\"] === \"object\" && themeOptions[\"encrypt\"]) {\n    // handle encrypt\n    const encrypt = themeOptions[\"encrypt\"] as Record<string, unknown>;\n\n    if (\"global\" in encrypt && typeof encrypt[\"global\"] !== \"boolean\") {\n      logger.warn(\n        'Setting admin password with \"encrypt.global\" in V1 is deprecated in V2, please use \"encrypt.admin\" instead.'\n      );\n\n      encrypt[\"admin\"] = encrypt[\"global\"];\n    }\n\n    if (\"status\" in encrypt) {\n      logger.warn(\n        '\"encrypt.status\" is deprecated, please use \"encrypt.global\" instead.'\n      );\n\n      encrypt[\"global\"] = encrypt[\"status\"] === \"global\";\n      delete encrypt[\"status\"];\n    }\n  }\n\n  if (\n    \"locales\" in themeOptions &&\n    typeof themeOptions[\"locales\"] === \"object\"\n  ) {\n    Object.values(themeOptions[\"locales\"]!).forEach(\n      (localeConfig: Record<string, unknown>) => {\n        DEPRECATED_THEME_OPTIONS.forEach(([deprecatedOption, newOption]) =>\n          deprecatedLogger({\n            options: localeConfig,\n            deprecatedOption,\n            newOption,\n            scope: \"themeConfig.locales\",\n          })\n        );\n        DROPPED_THEME_OPTIONS.forEach((item) =>\n          droppedLogger(localeConfig, ...item)\n        );\n\n        // handle navbar\n        if (\"navbar\" in localeConfig)\n          localeConfig[\"navbar\"] = convertNavbarOptions(localeConfig[\"navbar\"]);\n\n        // handle sidebar\n        if (\"sidebar\" in localeConfig)\n          localeConfig[\"sidebar\"] = convertSidebarOptions(\n            localeConfig[\"sidebar\"]\n          );\n\n        // handle footer\n        handleFooterOptions(localeConfig);\n\n        // handle blog\n        if (typeof localeConfig[\"blog\"] === \"object\" && localeConfig[\"blog\"]) {\n          handleBlogOptions(localeConfig[\"blog\"] as Record<string, unknown>);\n          if (!plugins[\"blog\"]) plugins[\"blog\"] = true;\n        }\n      }\n    );\n  }\n\n  return themeOptions;\n};\n"]}