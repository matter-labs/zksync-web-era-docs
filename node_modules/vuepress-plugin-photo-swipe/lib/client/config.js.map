{"version":3,"file":"config.js","sources":["../../src/client/define.ts","../../src/client/utils/index.ts","../../src/client/composables/setup.ts","../../src/client/config.ts"],"sourcesContent":["import type { PhotoSwipeInitOptions } from \"../shared/index.js\";\n\ndeclare const PHOTO_SWIPE_SELECTOR: string | string[];\ndeclare const PHOTO_SWIPE_DELAY: number;\ndeclare const PHOTO_SWIPE_OPTIONS: PhotoSwipeInitOptions;\ndeclare const PHOTO_SWIPE_LOCALES: Record<\n  string,\n  {\n    /**\n     * arrowPrev button title\n     */\n    arrowPrevTitle: string;\n\n    /**\n     * arrowNext button title\n     */\n    arrowNextTitle: string;\n\n    /**\n     * close button title\n     */\n    closeTitle: string;\n\n    /**\n     * download button title\n     */\n    downloadTitle: string;\n\n    /**\n     * fullscreen button title\n     */\n    fullscreenTitle: string;\n\n    /**\n     * zoom button title\n     */\n    zoomTitle: string;\n  }\n>;\n\nexport const imageSelector = PHOTO_SWIPE_SELECTOR;\n\nexport const locales = PHOTO_SWIPE_LOCALES;\nexport const delay = PHOTO_SWIPE_DELAY;\n\nexport const options = PHOTO_SWIPE_OPTIONS;\n","import type { DataSourceItem } from \"photoswipe\";\n\nexport const getImageInfo = (image: HTMLImageElement): DataSourceItem => ({\n  src: image.src,\n  width: image.naturalWidth,\n  height: image.naturalHeight,\n  alt: image.alt,\n});\n\nexport interface PhotoSwipeImages {\n  elements: HTMLImageElement[];\n  infos: DataSourceItem[];\n}\n\nexport const getImages = (\n  selector: string | string[]\n): Promise<PhotoSwipeImages> => {\n  const images =\n    typeof selector === \"string\"\n      ? Array.from(document.querySelectorAll<HTMLImageElement>(selector))\n      : selector\n          .map((item) =>\n            Array.from(document.querySelectorAll<HTMLImageElement>(item))\n          )\n          .flat();\n\n  return Promise.all(\n    images.map(\n      (image) =>\n        new Promise<DataSourceItem>((resolve, reject) => {\n          if (image.complete) resolve(getImageInfo(image));\n          else {\n            image.onload = (): void => resolve(getImageInfo(image));\n            image.onerror = (err): void => reject(err);\n          }\n        })\n    )\n  ).then((infos) => ({ elements: images, infos }));\n};\n","import { useFullscreen } from \"@vueuse/core\";\nimport { onMounted, watch } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport { useLocaleConfig } from \"vuepress-shared/client\";\n\nimport { delay, imageSelector, locales, options } from \"../define.js\";\nimport { getImages } from \"../utils/index.js\";\n\nimport \"photoswipe/dist/photoswipe.css\";\n\nexport const setupPhotoSwipe = (): void => {\n  const { isSupported, toggle } = useFullscreen();\n  const locale = useLocaleConfig(locales);\n  const route = useRoute();\n\n  const initPhotoSwipe = (): void => {\n    void Promise.all([\n      import(/* webpackChunkName: \"photo-swipe\" */ \"photoswipe\"),\n      new Promise<void>((resolve) => setTimeout(resolve, delay)).then(() =>\n        getImages(imageSelector)\n      ),\n    ]).then(([photoSwipe, images]) => {\n      images.elements.forEach((image, index) => {\n        const handler = (): void => {\n          const gallery = new photoSwipe.default({\n            dataSource: images.infos,\n            ...locale.value,\n            ...options,\n            index,\n          });\n\n          gallery.on(\"uiRegister\", () => {\n            if (isSupported)\n              // add fullscreen button\n              gallery.ui.registerElement({\n                name: \"fullscreen\",\n                order: 7,\n                isButton: true,\n\n                html: '<svg class=\"pswp__icn\" viewBox=\"0 0 1024 1024\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M249.5 270.833H437v-75H212a37.5 37.5 0 0 0-37.5 37.5v225h75v-187.5zm-37.5 600h225v-75H249.5v-187.5h-75v225a37.5 37.5 0 0 0 37.5 37.5zm637.5-37.5v-225h-75v187.5H587v75h225a37.5 37.5 0 0 0 37.5-37.5zM587 270.833h187.5v187.5h75v-225a37.5 37.5 0 0 0-37.5-37.5H587v75z\"/></svg>',\n\n                onClick: () => {\n                  void toggle();\n                },\n              });\n\n            // add download button\n            gallery.ui.registerElement({\n              name: \"download\",\n              order: 8,\n              isButton: true,\n              tagName: \"a\",\n\n              // SVG with outline\n              html: {\n                isCustomSVG: true,\n                inner:\n                  '<path d=\"M20.5 14.3 17.1 18V10h-2.2v7.9l-3.4-3.6L10 16l6 6.1 6-6.1-1.5-1.6ZM23 23H9v2h14\" id=\"pswp__icn-download\"/>',\n                outlineID: \"pswp__icn-download\",\n              },\n\n              onInit: (el: HTMLAnchorElement, pswp) => {\n                el.setAttribute(\"download\", \"\");\n                el.setAttribute(\"target\", \"_blank\");\n                el.setAttribute(\"rel\", \"noopener\");\n\n                pswp.on(\"change\", () => {\n                  el.href = pswp.currSlide.data.src;\n                });\n              },\n            });\n          });\n\n          gallery.init();\n        };\n\n        image.style.cursor = \"zoom-in\";\n        image.addEventListener(\"click\", handler);\n        image.addEventListener(\"keypress\", ({ key }) => {\n          if (key === \"Enter\") handler();\n        });\n      });\n    });\n  };\n\n  watch(\n    () => route.path,\n    () => initPhotoSwipe()\n  );\n\n  onMounted(() => initPhotoSwipe());\n};\n","import { defineClientConfig } from \"@vuepress/client\";\nimport { setupPhotoSwipe } from \"./composables/index.js\";\n\nexport default defineClientConfig({\n  setup: () => {\n    setupPhotoSwipe();\n  },\n});\n"],"names":["imageSelector","locales","delay","options","getImageInfo","image","getImages","selector","images","item","resolve","reject","err","infos","setupPhotoSwipe","isSupported","toggle","useFullscreen","locale","useLocaleConfig","route","useRoute","initPhotoSwipe","photoSwipe","index","handler","gallery","el","pswp","key","watch","onMounted","defineClientConfig"],"mappings":"oRAwCO,MAAMA,EAAgB,qBAEhBC,EAAU,oBACVC,EAAQ,kBAERC,EAAU,oBC3CVC,EAAgBC,IAA6C,CACxE,IAAKA,EAAM,IACX,MAAOA,EAAM,aACb,OAAQA,EAAM,cACd,IAAKA,EAAM,GACb,GAOaC,EACXC,GAC8B,CAC9B,MAAMC,EACJ,OAAOD,GAAa,SAChB,MAAM,KAAK,SAAS,iBAAmCA,CAAQ,CAAC,EAChEA,EACG,IAAKE,GACJ,MAAM,KAAK,SAAS,iBAAmCA,CAAI,CAAC,CAC9D,EACC,KAAK,EAEd,OAAO,QAAQ,IACbD,EAAO,IACJH,GACC,IAAI,QAAwB,CAACK,EAASC,IAAW,CAC3CN,EAAM,SAAUK,EAAQN,EAAaC,CAAK,CAAC,GAE7CA,EAAM,OAAS,IAAYK,EAAQN,EAAaC,CAAK,CAAC,EACtDA,EAAM,QAAWO,GAAcD,EAAOC,CAAG,EAE7C,CAAC,CACL,CACF,EAAE,KAAMC,IAAW,CAAE,SAAUL,EAAQ,MAAAK,CAAM,EAAE,CACjD,EC5BaC,EAAkB,IAAY,CACzC,KAAM,CAAE,YAAAC,EAAa,OAAAC,CAAO,EAAIC,IAC1BC,EAASC,EAAgBlB,CAAO,EAChCmB,EAAQC,EAAS,EAEjBC,EAAiB,IAAY,CAC5B,QAAQ,IAAI,CACf,OAA6C,cAC7C,IAAI,QAAeZ,GAAY,WAAWA,EAASR,CAAK,CAAC,EAAE,KAAK,IAC9DI,EAAUN,CAAa,CACzB,CACF,CAAC,EAAE,KAAK,CAAC,CAACuB,EAAYf,CAAM,IAAM,CAChCA,EAAO,SAAS,QAAQ,CAACH,EAAOmB,IAAU,CACxC,MAAMC,EAAU,IAAY,CAC1B,MAAMC,EAAU,IAAIH,EAAW,QAAQ,CACrC,WAAYf,EAAO,MACnB,GAAGU,EAAO,MACV,GAAGf,EACH,MAAAqB,CACF,CAAC,EAEDE,EAAQ,GAAG,aAAc,IAAM,CACzBX,GAEFW,EAAQ,GAAG,gBAAgB,CACzB,KAAM,aACN,MAAO,EACP,SAAU,GAEV,KAAM,8WAEN,QAAS,IAAM,CACRV,EAAO,CACd,CACF,CAAC,EAGHU,EAAQ,GAAG,gBAAgB,CACzB,KAAM,WACN,MAAO,EACP,SAAU,GACV,QAAS,IAGT,KAAM,CACJ,YAAa,GACb,MACE,sHACF,UAAW,oBACb,EAEA,OAAQ,CAACC,EAAuBC,IAAS,CACvCD,EAAG,aAAa,WAAY,EAAE,EAC9BA,EAAG,aAAa,SAAU,QAAQ,EAClCA,EAAG,aAAa,MAAO,UAAU,EAEjCC,EAAK,GAAG,SAAU,IAAM,CACtBD,EAAG,KAAOC,EAAK,UAAU,KAAK,GAChC,CAAC,CACH,CACF,CAAC,CACH,CAAC,EAEDF,EAAQ,MACV,EAEArB,EAAM,MAAM,OAAS,UACrBA,EAAM,iBAAiB,QAASoB,CAAO,EACvCpB,EAAM,iBAAiB,WAAY,CAAC,CAAE,IAAAwB,CAAI,IAAM,CAC1CA,IAAQ,SAASJ,EAAAA,CACvB,CAAC,CACH,CAAC,CACH,CAAC,CACH,EAEAK,EACE,IAAMV,EAAM,KACZ,IAAME,EACR,CAAA,EAEAS,EAAU,IAAMT,EAAe,CAAC,CAClC,ECxFA,IAAeU,EAAAA,EAAmB,CAChC,MAAO,IAAM,CACXlB,EAAgB,CAClB,CACF,CAAC"}